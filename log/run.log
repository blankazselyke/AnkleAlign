-----------------------------------
1. Running Preprocessing...
2025-12-13 20:56:27,352 - INFO - --- 1. STEP: DATA PREPROCESSING STARTED ---
2025-12-13 20:56:29,692 - INFO - Unzipping downloaded_dataset.zip...
2025-12-13 20:56:46,503 - INFO - Processing data from: /app/output/processed_data/anklealign
2025-12-13 20:56:55,855 - WARNING - No JSON in ECSGGY
2025-12-13 20:56:59,136 - WARNING - No JSON in GI9Y8B
2025-12-13 20:57:13,800 - INFO - Data processing complete. Processed 323 images.
2025-12-13 20:57:13,801 - INFO - CSV saved to: /app/output/processed_data/dataset.csv
2025-12-13 20:57:13,804 - INFO - CSV saved: 323 images.
2025-12-13 20:57:13,804 - INFO - Performing Stratified Train/Val/Test split...
2025-12-13 20:57:13,913 - INFO - Splits saved:
2025-12-13 20:57:13,913 - INFO -   Train: 257
2025-12-13 20:57:13,913 - INFO -   Val:   33
2025-12-13 20:57:13,913 - INFO -   Test:  33
-----------------------------------
2a. Running BASELINE Model...
2025-12-13 20:57:20,787 - INFO - --- BASELINE MODEL TRAINING STARTED ---
2025-12-13 20:57:20,787 - INFO - Baseline Hyperparameters:
2025-12-13 20:57:20,787 - INFO -   EPOCHS: 10
2025-12-13 20:57:20,787 - INFO -   BATCH_SIZE: 16
2025-12-13 20:57:20,787 - INFO -   LEARNING_RATE: 0.001
2025-12-13 20:57:20,788 - INFO - Device: cpu
2025-12-13 20:57:20,821 - INFO - --- Baseline Model Architecture ---
2025-12-13 20:57:20,821 - INFO - CNN(
  (conv1): Conv2d(3, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (fc1): Linear(in_features=25088, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=3, bias=True)
)
2025-12-13 20:57:20,821 - INFO - --- Parameter Count ---
2025-12-13 20:57:20,821 - INFO -   Total Parameters:         3217811
2025-12-13 20:57:20,821 - INFO -   Trainable Parameters:     3217811
2025-12-13 20:57:20,821 - INFO -   Non-trainable Parameters: 0
2025-12-13 20:57:20,822 - INFO - Starting baseline training...
2025-12-13 20:57:54,285 - INFO - Epoch 1/10 - Train Loss: 1.0702 - Train Acc: 0.3891 - Val Loss: 0.9647 - Val Acc: 0.4545
2025-12-13 20:58:23,130 - INFO - Epoch 2/10 - Train Loss: 0.9935 - Train Acc: 0.5447 - Val Loss: 0.9363 - Val Acc: 0.5758
2025-12-13 20:58:52,024 - INFO - Epoch 3/10 - Train Loss: 0.8304 - Train Acc: 0.5837 - Val Loss: 0.8831 - Val Acc: 0.5758
2025-12-13 20:59:21,453 - INFO - Epoch 4/10 - Train Loss: 0.6922 - Train Acc: 0.6848 - Val Loss: 0.9873 - Val Acc: 0.5152
2025-12-13 20:59:50,701 - INFO - Epoch 5/10 - Train Loss: 0.6019 - Train Acc: 0.7432 - Val Loss: 1.0125 - Val Acc: 0.6061
2025-12-13 21:00:24,239 - INFO - Epoch 6/10 - Train Loss: 0.4336 - Train Acc: 0.8288 - Val Loss: 1.2082 - Val Acc: 0.4545
2025-12-13 21:00:54,990 - INFO - Epoch 7/10 - Train Loss: 0.3484 - Train Acc: 0.8677 - Val Loss: 1.2295 - Val Acc: 0.3939
2025-12-13 21:01:24,654 - INFO - Epoch 8/10 - Train Loss: 0.2628 - Train Acc: 0.9222 - Val Loss: 1.5375 - Val Acc: 0.3939
2025-12-13 21:01:53,165 - INFO - Epoch 9/10 - Train Loss: 0.2199 - Train Acc: 0.9222 - Val Loss: 1.1329 - Val Acc: 0.5152
2025-12-13 21:02:23,560 - INFO - Epoch 10/10 - Train Loss: 0.1216 - Train Acc: 0.9689 - Val Loss: 1.6218 - Val Acc: 0.5455
2025-12-13 21:02:23,560 - INFO - Baseline training finished.
-----------------------------------
2b. Running MAIN Model (ResNet)...
2025-12-13 21:02:29,699 - INFO - --- 2. STEP: TRAINING STARTED ---
2025-12-13 21:02:29,699 - INFO - Hyperparameters:
2025-12-13 21:02:29,699 - INFO - EPOCHS: 30
2025-12-13 21:02:29,699 - INFO - BATCH_SIZE: 16
2025-12-13 21:02:29,699 - INFO - LEARNING_RATE: 1e-05
2025-12-13 21:02:29,699 - INFO - WEIGHT_DECAY: 0.01
2025-12-13 21:02:29,699 - INFO - EARLY_STOPPING_PATIENCE: 10
2025-12-13 21:02:29,699 - INFO - LR_SCHEDULER_FACTOR: 0.5
2025-12-13 21:02:29,700 - INFO - LR_SCHEDULER_PATIENCE: 5
2025-12-13 21:02:29,700 - INFO - Device: cpu
2025-12-13 21:02:29,754 - INFO - Data loaded successfully. Total samples: 323
2025-12-13 21:02:29,755 - INFO - Effective training samples: 771
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth
  0%|          | 0.00/44.7M [00:00<?, ?B/s]  5%|▌         | 2.25M/44.7M [00:00<00:01, 23.2MB/s] 14%|█▍        | 6.25M/44.7M [00:00<00:01, 34.0MB/s] 22%|██▏       | 10.0M/44.7M [00:00<00:00, 36.4MB/s] 30%|███       | 13.5M/44.7M [00:00<00:00, 34.7MB/s] 39%|███▊      | 17.2M/44.7M [00:00<00:00, 35.8MB/s] 47%|████▋     | 20.9M/44.7M [00:00<00:00, 36.4MB/s] 55%|█████▍    | 24.4M/44.7M [00:00<00:00, 35.8MB/s] 63%|██████▎   | 28.1M/44.7M [00:00<00:00, 36.5MB/s] 71%|███████   | 31.8M/44.7M [00:00<00:00, 36.6MB/s] 79%|███████▉  | 35.4M/44.7M [00:01<00:00, 36.8MB/s] 87%|████████▋ | 39.0M/44.7M [00:01<00:00, 37.0MB/s] 96%|█████████▌| 42.9M/44.7M [00:01<00:00, 38.0MB/s]100%|██████████| 44.7M/44.7M [00:01<00:00, 36.4MB/s]
2025-12-13 21:02:31,604 - INFO - --- ResNet18 Model Architecture ---
2025-12-13 21:02:31,605 - INFO - ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=3, bias=True)
)
2025-12-13 21:02:31,605 - INFO - --- Parameter Count ---
2025-12-13 21:02:31,605 - INFO -   Total Parameters:         11178051
2025-12-13 21:02:31,605 - INFO -   Trainable Parameters:     11178051
2025-12-13 21:02:31,605 - INFO -   Non-trainable Parameters: 0
2025-12-13 21:04:50,268 - INFO - Epoch 1/30 - Train Loss: 1.2192 - Train Acc: 0.3645 - Val Loss: 1.1285 - Val Acc: 0.3636
2025-12-13 21:04:50,634 - INFO - New best model saved! Val loss: 1.1285
2025-12-13 21:07:01,250 - INFO - Epoch 2/30 - Train Loss: 0.9288 - Train Acc: 0.5992 - Val Loss: 0.9368 - Val Acc: 0.5758
2025-12-13 21:07:01,495 - INFO - New best model saved! Val loss: 0.9368
2025-12-13 21:08:40,674 - INFO - Epoch 3/30 - Train Loss: 0.7604 - Train Acc: 0.7250 - Val Loss: 0.8644 - Val Acc: 0.5455
2025-12-13 21:08:40,982 - INFO - New best model saved! Val loss: 0.8644
2025-12-13 21:09:58,494 - INFO - Epoch 4/30 - Train Loss: 0.6069 - Train Acc: 0.8223 - Val Loss: 0.8307 - Val Acc: 0.6061
2025-12-13 21:09:58,791 - INFO - New best model saved! Val loss: 0.8307
2025-12-13 21:11:09,611 - INFO - Epoch 5/30 - Train Loss: 0.4986 - Train Acc: 0.8846 - Val Loss: 0.8317 - Val Acc: 0.6667
2025-12-13 21:11:09,611 - INFO - No improvement for 1 epochs.
2025-12-13 21:12:12,285 - INFO - Epoch 6/30 - Train Loss: 0.4294 - Train Acc: 0.8975 - Val Loss: 0.7739 - Val Acc: 0.6364
2025-12-13 21:12:12,495 - INFO - New best model saved! Val loss: 0.7739
2025-12-13 21:13:14,678 - INFO - Epoch 7/30 - Train Loss: 0.3588 - Train Acc: 0.9261 - Val Loss: 0.7647 - Val Acc: 0.6667
2025-12-13 21:13:14,886 - INFO - New best model saved! Val loss: 0.7647
2025-12-13 21:14:18,093 - INFO - Epoch 8/30 - Train Loss: 0.2852 - Train Acc: 0.9507 - Val Loss: 0.7792 - Val Acc: 0.6970
2025-12-13 21:14:18,093 - INFO - No improvement for 1 epochs.
2025-12-13 21:15:20,157 - INFO - Epoch 9/30 - Train Loss: 0.2371 - Train Acc: 0.9494 - Val Loss: 0.7648 - Val Acc: 0.7273
2025-12-13 21:15:20,157 - INFO - No improvement for 2 epochs.
2025-12-13 21:16:22,586 - INFO - Epoch 10/30 - Train Loss: 0.2066 - Train Acc: 0.9637 - Val Loss: 0.7778 - Val Acc: 0.7273
2025-12-13 21:16:22,587 - INFO - No improvement for 3 epochs.
2025-12-13 21:17:24,791 - INFO - Epoch 11/30 - Train Loss: 0.1738 - Train Acc: 0.9728 - Val Loss: 0.7747 - Val Acc: 0.6970
2025-12-13 21:17:24,791 - INFO - No improvement for 4 epochs.
2025-12-13 21:18:27,608 - INFO - Epoch 12/30 - Train Loss: 0.1760 - Train Acc: 0.9624 - Val Loss: 0.8152 - Val Acc: 0.6970
2025-12-13 21:18:27,608 - INFO - No improvement for 5 epochs.
2025-12-13 21:19:30,135 - INFO - Epoch 13/30 - Train Loss: 0.1428 - Train Acc: 0.9715 - Val Loss: 0.8008 - Val Acc: 0.6970
2025-12-13 21:19:30,135 - INFO - No improvement for 6 epochs.
2025-12-13 21:20:32,516 - INFO - Epoch 14/30 - Train Loss: 0.1223 - Train Acc: 0.9805 - Val Loss: 0.8002 - Val Acc: 0.6970
2025-12-13 21:20:32,516 - INFO - No improvement for 7 epochs.
2025-12-13 21:21:34,742 - INFO - Epoch 15/30 - Train Loss: 0.1296 - Train Acc: 0.9689 - Val Loss: 0.7333 - Val Acc: 0.6970
2025-12-13 21:21:34,954 - INFO - New best model saved! Val loss: 0.7333
2025-12-13 21:22:37,126 - INFO - Epoch 16/30 - Train Loss: 0.1127 - Train Acc: 0.9728 - Val Loss: 0.8223 - Val Acc: 0.6970
2025-12-13 21:22:37,126 - INFO - No improvement for 1 epochs.
2025-12-13 21:23:40,437 - INFO - Epoch 17/30 - Train Loss: 0.1076 - Train Acc: 0.9805 - Val Loss: 0.7836 - Val Acc: 0.6667
2025-12-13 21:23:40,437 - INFO - No improvement for 2 epochs.
2025-12-13 21:24:42,496 - INFO - Epoch 18/30 - Train Loss: 0.1208 - Train Acc: 0.9715 - Val Loss: 0.8274 - Val Acc: 0.6667
2025-12-13 21:24:42,496 - INFO - No improvement for 3 epochs.
2025-12-13 21:25:44,524 - INFO - Epoch 19/30 - Train Loss: 0.0922 - Train Acc: 0.9831 - Val Loss: 0.8063 - Val Acc: 0.6970
2025-12-13 21:25:44,524 - INFO - No improvement for 4 epochs.
2025-12-13 21:26:46,972 - INFO - Epoch 20/30 - Train Loss: 0.0959 - Train Acc: 0.9754 - Val Loss: 0.8503 - Val Acc: 0.6667
2025-12-13 21:26:46,972 - INFO - No improvement for 5 epochs.
2025-12-13 21:27:49,082 - INFO - Epoch 21/30 - Train Loss: 0.0915 - Train Acc: 0.9780 - Val Loss: 0.8458 - Val Acc: 0.6667
2025-12-13 21:27:49,082 - INFO - No improvement for 6 epochs.
2025-12-13 21:28:51,104 - INFO - Epoch 22/30 - Train Loss: 0.0810 - Train Acc: 0.9805 - Val Loss: 0.8752 - Val Acc: 0.6970
2025-12-13 21:28:51,104 - INFO - No improvement for 7 epochs.
2025-12-13 21:29:53,088 - INFO - Epoch 23/30 - Train Loss: 0.0860 - Train Acc: 0.9805 - Val Loss: 0.8410 - Val Acc: 0.6667
2025-12-13 21:29:53,088 - INFO - No improvement for 8 epochs.
2025-12-13 21:30:55,601 - INFO - Epoch 24/30 - Train Loss: 0.0848 - Train Acc: 0.9896 - Val Loss: 0.8908 - Val Acc: 0.6970
2025-12-13 21:30:55,601 - INFO - No improvement for 9 epochs.
2025-12-13 21:31:58,793 - INFO - Epoch 25/30 - Train Loss: 0.0704 - Train Acc: 0.9805 - Val Loss: 0.8433 - Val Acc: 0.6970
2025-12-13 21:31:58,793 - INFO - No improvement for 10 epochs.
2025-12-13 21:31:58,793 - INFO - Early stopping triggered.
2025-12-13 21:31:58,793 - INFO - Training finished.
-----------------------------------
3. Running Evaluation...
2025-12-13 21:32:02,103 - INFO - --- 3. STEP: EVALUATION STARTED ---
2025-12-13 21:32:02,103 - INFO - Device: cpu
2025-12-13 21:32:02,108 - INFO - Test samples loaded: 33
2025-12-13 21:32:02,190 - INFO - --- Evaluating: Baseline (CNN) ---
2025-12-13 21:32:04,125 - INFO - FINAL TEST ACCURACY (Baseline (CNN)): 0.5455
2025-12-13 21:32:04,127 - INFO - Confusion Matrix (Baseline (CNN)):
2025-12-13 21:32:04,127 - INFO - 
[[ 4  9  1]
 [ 2 12  0]
 [ 1  2  2]]
2025-12-13 21:32:04,133 - INFO - Classification Report (Baseline (CNN)):
2025-12-13 21:32:04,133 - INFO - 
              precision    recall  f1-score   support

   Pronation       0.57      0.29      0.38        14
     Neutral       0.52      0.86      0.65        14
  Supination       0.67      0.40      0.50         5

    accuracy                           0.55        33
   macro avg       0.59      0.51      0.51        33
weighted avg       0.56      0.55      0.51        33

2025-12-13 21:32:04,133 - INFO - ----------------------------------------
2025-12-13 21:32:04,383 - INFO - --- Evaluating: Main Model (ResNet18) ---
2025-12-13 21:32:06,502 - INFO - FINAL TEST ACCURACY (Main Model (ResNet18)): 0.6970
2025-12-13 21:32:06,503 - INFO - Confusion Matrix (Main Model (ResNet18)):
2025-12-13 21:32:06,503 - INFO - 
[[ 9  5  0]
 [ 2 11  1]
 [ 2  0  3]]
2025-12-13 21:32:06,507 - INFO - Classification Report (Main Model (ResNet18)):
2025-12-13 21:32:06,508 - INFO - 
              precision    recall  f1-score   support

   Pronation       0.69      0.64      0.67        14
     Neutral       0.69      0.79      0.73        14
  Supination       0.75      0.60      0.67         5

    accuracy                           0.70        33
   macro avg       0.71      0.68      0.69        33
weighted avg       0.70      0.70      0.69        33

2025-12-13 21:32:06,508 - INFO - ----------------------------------------
2025-12-13 21:32:06,508 - INFO - --- EVALUATION FINISHED SUCCESSFULLY ---
-----------------------------------
4. Running Inference...
2025-12-13 21:32:09,137 - INFO - --- 4. INFERENCE STARTED ---
2025-12-13 21:32:09,432 - INFO - Model successfully loaded from /app/output/best_model.pth
2025-12-13 21:32:09,471 - INFO - Image: /app/data/inference/internet_pinterest_01.jpg → Predicted class: Pronacio
2025-12-13 21:32:09,490 - INFO - Image: /app/data/inference/internet_random_02.jpg → Predicted class: Neutralis
2025-12-13 21:32:09,494 - INFO - Inference completed. Results saved to: /app/output/inference_results.csv
Pipeline finished successfully.
