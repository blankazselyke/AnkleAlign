-----------------------------------
1. Running Preprocessing...
2025-12-14 10:14:48,136 - INFO - Step 1: Data Preprocessing Started
2025-12-14 10:14:48,686 - INFO - Unzipping downloaded_dataset.zip...
2025-12-14 10:14:59,118 - INFO - Processing data from: /app/output/processed_data/anklealign
2025-12-14 10:15:01,810 - WARNING - No JSON annotation found in ECSGGY
2025-12-14 10:15:03,534 - WARNING - No JSON annotation found in GI9Y8B
2025-12-14 10:15:08,814 - INFO - Full dataset created: 323 images.
2025-12-14 10:15:08,815 - INFO - Performing Stratified Split...
2025-12-14 10:15:08,895 - INFO - Splits saved: Train(257), Val(33), Test(33)
-----------------------------------
2a. Running BASELINE Model...
2025-12-14 10:15:14,510 - INFO - --- BASELINE MODEL TRAINING STARTED ---
2025-12-14 10:15:14,510 - INFO - Baseline Hyperparameters:
2025-12-14 10:15:14,510 - INFO -   EPOCHS: 10
2025-12-14 10:15:14,510 - INFO -   BATCH_SIZE: 16
2025-12-14 10:15:14,511 - INFO -   LEARNING_RATE: 0.001
2025-12-14 10:15:14,511 - INFO - Device: cpu
2025-12-14 10:15:14,611 - INFO - --- Baseline Model Architecture ---
2025-12-14 10:15:14,611 - INFO - CNN(
  (conv1): Conv2d(3, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv3): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (fc1): Linear(in_features=25088, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=3, bias=True)
)
2025-12-14 10:15:14,611 - INFO - --- Parameter Count ---
2025-12-14 10:15:14,611 - INFO -   Total Parameters:         3217811
2025-12-14 10:15:14,611 - INFO -   Trainable Parameters:     3217811
2025-12-14 10:15:14,611 - INFO -   Non-trainable Parameters: 0
2025-12-14 10:15:14,611 - INFO - Starting baseline training...
2025-12-14 10:15:33,149 - INFO - Epoch 1/10 - Train Loss: 1.0823 - Train Acc: 0.4163 - Val Loss: 1.0061 - Val Acc: 0.4242
2025-12-14 10:15:49,159 - INFO - Epoch 2/10 - Train Loss: 1.0135 - Train Acc: 0.4514 - Val Loss: 0.9709 - Val Acc: 0.3333
2025-12-14 10:16:04,714 - INFO - Epoch 3/10 - Train Loss: 0.9732 - Train Acc: 0.4747 - Val Loss: 0.9548 - Val Acc: 0.5152
2025-12-14 10:16:20,302 - INFO - Epoch 4/10 - Train Loss: 0.9176 - Train Acc: 0.5370 - Val Loss: 0.9324 - Val Acc: 0.4242
2025-12-14 10:16:36,099 - INFO - Epoch 5/10 - Train Loss: 0.8356 - Train Acc: 0.6265 - Val Loss: 0.9190 - Val Acc: 0.4545
2025-12-14 10:16:51,709 - INFO - Epoch 6/10 - Train Loss: 0.7250 - Train Acc: 0.6576 - Val Loss: 0.9959 - Val Acc: 0.5455
2025-12-14 10:17:07,547 - INFO - Epoch 7/10 - Train Loss: 0.5727 - Train Acc: 0.7510 - Val Loss: 1.0539 - Val Acc: 0.6364
2025-12-14 10:17:23,374 - INFO - Epoch 8/10 - Train Loss: 0.5549 - Train Acc: 0.7743 - Val Loss: 1.0009 - Val Acc: 0.4848
2025-12-14 10:17:38,789 - INFO - Epoch 9/10 - Train Loss: 0.4531 - Train Acc: 0.8327 - Val Loss: 0.9754 - Val Acc: 0.6364
2025-12-14 10:17:54,714 - INFO - Epoch 10/10 - Train Loss: 0.3499 - Train Acc: 0.8949 - Val Loss: 1.1201 - Val Acc: 0.5152
2025-12-14 10:17:54,714 - INFO - Baseline training finished.
-----------------------------------
2b. Running MAIN Model (ResNet)...
2025-12-14 10:17:57,675 - INFO - --- 2. STEP: TRAINING STARTED ---
2025-12-14 10:17:57,675 - INFO - Hyperparameters:
2025-12-14 10:17:57,675 - INFO - EPOCHS: 30
2025-12-14 10:17:57,675 - INFO - BATCH_SIZE: 16
2025-12-14 10:17:57,675 - INFO - LEARNING_RATE: 1e-05
2025-12-14 10:17:57,675 - INFO - WEIGHT_DECAY: 0.01
2025-12-14 10:17:57,675 - INFO - EARLY_STOPPING_PATIENCE: 10
2025-12-14 10:17:57,675 - INFO - LR_SCHEDULER_FACTOR: 0.5
2025-12-14 10:17:57,675 - INFO - LR_SCHEDULER_PATIENCE: 5
2025-12-14 10:17:57,676 - INFO - Device: cpu
2025-12-14 10:17:57,684 - INFO - Data loaded successfully. Total samples: 323
2025-12-14 10:17:57,685 - INFO - Effective training samples: 771
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth
100%|██████████| 44.7M/44.7M [00:00<00:00, 50.8MB/s]
2025-12-14 10:17:58,991 - INFO - --- ResNet18 Model Architecture ---
2025-12-14 10:17:58,991 - INFO - ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=3, bias=True)
)
2025-12-14 10:17:58,991 - INFO - --- Parameter Count ---
2025-12-14 10:17:58,992 - INFO -   Total Parameters:         11178051
2025-12-14 10:17:58,992 - INFO -   Trainable Parameters:     11178051
2025-12-14 10:17:58,992 - INFO -   Non-trainable Parameters: 0
2025-12-14 10:19:03,708 - INFO - Epoch 1/30 - Train Loss: 1.1205 - Train Acc: 0.4215 - Val Loss: 0.8902 - Val Acc: 0.5152
2025-12-14 10:19:03,917 - INFO - New best model saved! Val loss: 0.8902
2025-12-14 10:20:07,080 - INFO - Epoch 2/30 - Train Loss: 0.8496 - Train Acc: 0.5850 - Val Loss: 0.7831 - Val Acc: 0.6667
2025-12-14 10:20:07,289 - INFO - New best model saved! Val loss: 0.7831
2025-12-14 10:21:11,288 - INFO - Epoch 3/30 - Train Loss: 0.6986 - Train Acc: 0.7237 - Val Loss: 0.7129 - Val Acc: 0.7273
2025-12-14 10:21:11,503 - INFO - New best model saved! Val loss: 0.7129
2025-12-14 10:22:14,876 - INFO - Epoch 4/30 - Train Loss: 0.5766 - Train Acc: 0.8249 - Val Loss: 0.6761 - Val Acc: 0.7879
2025-12-14 10:22:15,087 - INFO - New best model saved! Val loss: 0.6761
2025-12-14 10:23:19,022 - INFO - Epoch 5/30 - Train Loss: 0.5030 - Train Acc: 0.8625 - Val Loss: 0.6531 - Val Acc: 0.7879
2025-12-14 10:23:19,258 - INFO - New best model saved! Val loss: 0.6531
2025-12-14 10:24:23,869 - INFO - Epoch 6/30 - Train Loss: 0.3949 - Train Acc: 0.9040 - Val Loss: 0.6528 - Val Acc: 0.7879
2025-12-14 10:24:24,080 - INFO - New best model saved! Val loss: 0.6528
2025-12-14 10:25:26,905 - INFO - Epoch 7/30 - Train Loss: 0.3420 - Train Acc: 0.9183 - Val Loss: 0.6459 - Val Acc: 0.7879
2025-12-14 10:25:27,116 - INFO - New best model saved! Val loss: 0.6459
2025-12-14 10:26:30,426 - INFO - Epoch 8/30 - Train Loss: 0.2922 - Train Acc: 0.9468 - Val Loss: 0.6443 - Val Acc: 0.7879
2025-12-14 10:26:30,638 - INFO - New best model saved! Val loss: 0.6443
2025-12-14 10:27:33,980 - INFO - Epoch 9/30 - Train Loss: 0.2447 - Train Acc: 0.9611 - Val Loss: 0.6388 - Val Acc: 0.7879
2025-12-14 10:27:34,192 - INFO - New best model saved! Val loss: 0.6388
2025-12-14 10:28:36,779 - INFO - Epoch 10/30 - Train Loss: 0.2114 - Train Acc: 0.9637 - Val Loss: 0.6328 - Val Acc: 0.7576
2025-12-14 10:28:36,987 - INFO - New best model saved! Val loss: 0.6328
2025-12-14 10:29:41,136 - INFO - Epoch 11/30 - Train Loss: 0.2011 - Train Acc: 0.9650 - Val Loss: 0.6548 - Val Acc: 0.7576
2025-12-14 10:29:41,136 - INFO - No improvement for 1 epochs.
2025-12-14 10:30:44,125 - INFO - Epoch 12/30 - Train Loss: 0.1595 - Train Acc: 0.9754 - Val Loss: 0.6796 - Val Acc: 0.7879
2025-12-14 10:30:44,125 - INFO - No improvement for 2 epochs.
2025-12-14 10:31:47,378 - INFO - Epoch 13/30 - Train Loss: 0.1349 - Train Acc: 0.9780 - Val Loss: 0.6907 - Val Acc: 0.7879
2025-12-14 10:31:47,378 - INFO - No improvement for 3 epochs.
2025-12-14 10:32:51,025 - INFO - Epoch 14/30 - Train Loss: 0.1375 - Train Acc: 0.9702 - Val Loss: 0.7276 - Val Acc: 0.7879
2025-12-14 10:32:51,025 - INFO - No improvement for 4 epochs.
2025-12-14 10:33:54,700 - INFO - Epoch 15/30 - Train Loss: 0.1074 - Train Acc: 0.9818 - Val Loss: 0.7287 - Val Acc: 0.7879
2025-12-14 10:33:54,700 - INFO - No improvement for 5 epochs.
2025-12-14 10:34:58,851 - INFO - Epoch 16/30 - Train Loss: 0.0994 - Train Acc: 0.9767 - Val Loss: 0.7580 - Val Acc: 0.7273
2025-12-14 10:34:58,851 - INFO - No improvement for 6 epochs.
2025-12-14 10:36:02,153 - INFO - Epoch 17/30 - Train Loss: 0.0995 - Train Acc: 0.9805 - Val Loss: 0.7085 - Val Acc: 0.7576
2025-12-14 10:36:02,153 - INFO - No improvement for 7 epochs.
2025-12-14 10:37:05,382 - INFO - Epoch 18/30 - Train Loss: 0.1072 - Train Acc: 0.9715 - Val Loss: 0.7607 - Val Acc: 0.7576
2025-12-14 10:37:05,382 - INFO - No improvement for 8 epochs.
2025-12-14 10:38:09,695 - INFO - Epoch 19/30 - Train Loss: 0.0977 - Train Acc: 0.9805 - Val Loss: 0.7755 - Val Acc: 0.7576
2025-12-14 10:38:09,695 - INFO - No improvement for 9 epochs.
2025-12-14 10:39:13,540 - INFO - Epoch 20/30 - Train Loss: 0.0824 - Train Acc: 0.9896 - Val Loss: 0.7135 - Val Acc: 0.7576
2025-12-14 10:39:13,541 - INFO - No improvement for 10 epochs.
2025-12-14 10:39:13,541 - INFO - Early stopping triggered.
2025-12-14 10:39:13,541 - INFO - Training finished.
-----------------------------------
3. Running Evaluation...
2025-12-14 10:39:17,004 - INFO - --- 3. STEP: EVALUATION STARTED ---
2025-12-14 10:39:17,004 - INFO - Device: cpu
2025-12-14 10:39:17,022 - INFO - Test samples loaded: 33
2025-12-14 10:39:17,450 - INFO - --- Evaluating: Baseline (CNN) ---
2025-12-14 10:39:20,419 - INFO - FINAL TEST ACCURACY (Baseline (CNN)): 0.4545
2025-12-14 10:39:20,422 - INFO - Confusion Matrix (Baseline (CNN)):
2025-12-14 10:39:20,422 - INFO -
[[8 6 0]
 [7 7 0]
 [5 0 0]]
2025-12-14 10:39:20,427 - INFO - Classification Report (Baseline (CNN)):
2025-12-14 10:39:20,427 - INFO -
              precision    recall  f1-score   support

   Pronation       0.40      0.57      0.47        14
     Neutral       0.54      0.50      0.52        14
  Supination       0.00      0.00      0.00         5

    accuracy                           0.45        33
   macro avg       0.31      0.36      0.33        33
weighted avg       0.40      0.45      0.42        33

2025-12-14 10:39:20,427 - INFO - ----------------------------------------
2025-12-14 10:39:20,695 - INFO - --- Evaluating: Main Model (ResNet18) ---
2025-12-14 10:39:22,742 - INFO - FINAL TEST ACCURACY (Main Model (ResNet18)): 0.7273
2025-12-14 10:39:22,743 - INFO - Confusion Matrix (Main Model (ResNet18)):
2025-12-14 10:39:22,743 - INFO -
[[10  3  1]
 [ 2 11  1]
 [ 2  0  3]]
2025-12-14 10:39:22,749 - INFO - Classification Report (Main Model (ResNet18)):
2025-12-14 10:39:22,749 - INFO -
              precision    recall  f1-score   support

   Pronation       0.71      0.71      0.71        14
     Neutral       0.79      0.79      0.79        14
  Supination       0.60      0.60      0.60         5

    accuracy                           0.73        33
   macro avg       0.70      0.70      0.70        33
weighted avg       0.73      0.73      0.73        33

2025-12-14 10:39:22,749 - INFO - ----------------------------------------
2025-12-14 10:39:22,749 - INFO - --- EVALUATION FINISHED SUCCESSFULLY ---
-----------------------------------
4. Running Inference...
2025-12-14 10:39:25,430 - INFO - --- 4. INFERENCE STARTED ---
2025-12-14 10:39:25,728 - INFO - Model successfully loaded from /app/output/best_model.pth
2025-12-14 10:39:25,780 - INFO - Image: /app/data/inference/internet_pinterest_01.jpg → Predicted class: Pronacio
2025-12-14 10:39:25,817 - INFO - Image: /app/data/inference/internet_random_02.jpg → Predicted class: Pronacio
2025-12-14 10:39:25,824 - INFO - Inference completed. Results saved to: /app/output/inference_results.csv
Pipeline finished successfully.